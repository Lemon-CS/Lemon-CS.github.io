<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Java内省机制 | Lemon-CS</title><meta name="keywords" content="内省"><meta name="author" content="空白格"><meta name="copyright" content="空白格"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="Java内省机制的使用及其实现原理，Java反射机制和内省机制的区别"><meta property="og:type" content="article"><meta property="og:title" content="Java内省机制"><meta property="og:url" content="https://lemon-cs.github.io/2020/07/18/Java%E5%86%85%E7%9C%81%E6%9C%BA%E5%88%B6/index.html"><meta property="og:site_name" content="Lemon-CS"><meta property="og:description" content="Java内省机制的使用及其实现原理，Java反射机制和内省机制的区别"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://static01.imgkr.com/temp/67e21ea4f0cb464cb52de4d60aad3962.jpg"><meta property="article:published_time" content="2020-07-18T09:20:41.000Z"><meta property="article:modified_time" content="2021-12-29T07:37:35.000Z"><meta property="article:author" content="空白格"><meta property="article:tag" content="Java"><meta property="article:tag" content="内省"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://static01.imgkr.com/temp/67e21ea4f0cb464cb52de4d60aad3962.jpg"><link rel="shortcut icon" href="https://gitee.com/lemon-cs/images/raw/master/Blog.png"><link rel="canonical" href="https://lemon-cs.github.io/2020/07/18/Java%E5%86%85%E7%9C%81%E6%9C%BA%E5%88%B6/"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:600},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{limitCount:50,languages:{author:"作者: 空白格",link:"链接: ",source:"来源: Lemon-CS",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。"}},lightbox:"fancybox",Snackbar:void 0,source:{jQuery:"https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js",justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js",css:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css"},fancybox:{js:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js",css:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"}},isPhotoFigcaption:!0,islazyload:!1,isanchor:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"Java内省机制",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2021-12-29 15:37:35"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,o){if(0===o)return;const a=864e5*o,c={value:t,expiry:(new Date).getTime()+a};localStorage.setItem(e,JSON.stringify(c))},get:function(e){const t=localStorage.getItem(e);if(!t)return;const o=JSON.parse(t);if(!((new Date).getTime()>o.expiry))return o.value;localStorage.removeItem(e)}},e.getScript=e=>new Promise((t,o)=>{const a=document.createElement("script");a.src=e,a.async=!0,a.onerror=o,a.onload=a.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};const t=saveToLocal.get("theme"),o=window.matchMedia("(prefers-color-scheme: dark)").matches,a=window.matchMedia("(prefers-color-scheme: light)").matches,c=window.matchMedia("(prefers-color-scheme: no-preference)").matches,n=!o&&!a&&!c;if(void 0===t){if(a)activateLightMode();else if(o)activateDarkMode();else if(c||n){const e=(new Date).getHours();e<=6||e>=18?activateDarkMode():activateLightMode()}window.matchMedia("(prefers-color-scheme: dark)").addListener((function(e){void 0===saveToLocal.get("theme")&&(e.matches?activateDarkMode():activateLightMode())}))}else"light"===t?activateLightMode():activateDarkMode();const i=saveToLocal.get("aside-status");void 0!==i&&("hide"===i?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));const d=saveToLocal.get("global-font-size");void 0!==d&&document.documentElement.style.setProperty("--global-font-size",d+"px");const r=()=>{GLOBAL_CONFIG_SITE.isHome&&/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")};r(),document.addEventListener("pjax:complete",r)})(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/constown/HexoCustomFile@0.0.4/dist/css/custom.min.css"><meta name="generator" content="Hexo 5.4.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/./images/avatar.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">文章</div><div class="length-num">77</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">标签</div><div class="length-num">72</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://static01.imgkr.com/temp/67e21ea4f0cb464cb52de4d60aad3962.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Lemon-CS</a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Java内省机制</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-07-18T09:20:41.000Z" title="发表于 2020-07-18 17:20:41">2020-07-18</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2021-12-29T07:37:35.000Z" title="更新于 2021-12-29 15:37:35">2021-12-29</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Java/">Java</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.3k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>28分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="Java内省机制"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="基本概念"><a href="#基本概念" class="headerlink" title="基本概念"></a>基本概念</h1><h2 id="Java反射机制"><a href="#Java反射机制" class="headerlink" title="Java反射机制"></a>Java反射机制</h2><p>反射是Java 编程语言中的一个特性。它允许正在执行的Java 程序检查或“内省”自身，并操纵程序的内部属性。 例如，Java类可以获取其所有成员的名称并显示它们。因此，反射提供了以下一些功能:</p><ul><li>获取某个类定义的方法信息，包括方法名，参数，返回值等信息。</li><li>获取某个类的构造函数。</li><li>获取某个类的属性。</li><li>通过方法名调用类的相应的方法。</li><li>修改对象的属性值。</li><li>创建某个类对应的对象。</li></ul><p>更多反射的详情可以参考文章</p><h2 id="Java内省机制"><a href="#Java内省机制" class="headerlink" title="Java内省机制"></a>Java内省机制</h2><p>使用内省相对于直接使用反射更加安全可靠，Java的反射机制比较特殊，它不同于一般的编程方式，稍不小心就容易破坏类的封装性。练的不好，就容易走火入魔。没关系，很多时候我们还可以使用Java的内省机制。</p><h3 id="Java的内省机制是什么？"><a href="#Java的内省机制是什么？" class="headerlink" title="Java的内省机制是什么？"></a>Java的内省机制是什么？</h3><p>在计算机科学中，内省是指计算机程序在运行时（Run time）检查对象（Object）类型的一种能力，通常也可以称作运行时类型检查。</p><blockquote><p>内省（Introspection ）在心理学中，它是心理学基本研究方法之一。内省法又称自我观察法。它是发生在内部的，我们自己能够意识到的主观现象。也可以说是对于自己的主观经验及其变化的观察。正因为它的主观性，内省法自古以来就成为心理学界长期的争论。争论于它是否客观，是否可靠。另外内省也可看作自我反省，也是儒家强调的自我思考。从这个角度说它可以应用于计算机领域，例如Java内省机制和cocoa内省机制。</p><p>Java语言内省（Introspector）是Java语言对Bean类属性、事件的一种缺省处理方法。例如类A中有属性name,那我们可以通过getName,setName来得到其值或者设置新的值。通过getName/setName来访问name属性，这就是默认的规则。Java中提供了一套API用来访问某个属性的getter/setter方法，通过这些API可以使你不需要了解这个规则（但你最好还是要搞清楚），这些API存放于包java.beans中。<br>一般的做法是通过类Introspector来获取某个对象的BeanInfo信息，然后通过BeanInfo来获取属性的描述器（PropertyDescriptor），通过这个属性描述器就可以获取某个属性对应的getter/setter方法，然后我们就可以通过反射机制来调用这些方法。</p></blockquote><p>以上就是百科的解释。Java的内省最终是用Java的反射实现的。那为什么不直接用反射，要使用内省呢？</p><p>在Java中，内省的实现为：</p><ol><li> 内省（Introspector）是Java语言对Bean类属性、事件的一种缺省处理方法。</li><li> 例如类A中有属性name,那我们可以通过getName,setName来得到其值或者设置新的值。</li><li> 通过getName/setName来访问name属性，这就是默认的规则。</li><li> Java中提供了一套API用来访问某个属性的getter/setter方法，通过这些API可以使你不需要了解这个规则，</li><li> 这些API存放于包java.beans中。</li></ol><blockquote><ol><li> 一般的做法是通过类Introspector来获取某个对象的BeanInfo信息，</li><li> 然后通过BeanInfo来获取属性的描述器（PropertyDescriptor），</li><li> 通过这个属性描述器就可以获取某个属性对应的getter/setter方法， </li><li>然后我们就可以通过反射机制来调用这些方法。</li></ol></blockquote><h3 id="内省-Introspector"><a href="#内省-Introspector" class="headerlink" title="内省(Introspector)"></a>内省(Introspector)</h3><p><strong>内省(Introspector)：</strong> 是指对 JavaBean 类属性、事件处理的一套方法。内省就是基于反射实现的，是对反射的一种封装。</p><p>理解：</p><p>（1）对于一个普通的javabean，反射可以用<code>Class&lt;?&gt;</code>(字节码文件对象类)对这个javabean进行描述，描述这个普通的javabean的类型、属性信息、构造器信息、方法信息等，进而可以通过这些信息动态创建对象来使用；而内省就是对于一个普通的javabean，将这个javabean所有的属性信息、构造器信息、方法信息等封装（或构造）成一个新的beaninfo对象，然后用<code>Introspector类</code>来对这个beaninfo进行操作，进而来获得BeanDescriptor(bean描述器)、PropertyDescriptor(属性描述器)、MethodDescriptor(方法描述器)、 EventSetDescriptor(事件描述器)等</p><p>（2）内省的具体体现</p><p>例如：我们对idea中代码字体的大小进行设置，我们在设置框中字体大小栏输入12或16等时，可以看到下方的示例字体大小也随之发生改变，这里就用到了内省机制中的事件监听，若有变化则自我感知从而发生改变；</p><p>还例如：在反射中我们说对于一个User.java类，当new一个对象后，User user = new User();我们可以通过user. 的形式来知道这个对象中封装了哪些方法，像我们可以这样 Integer id = user.getId();来获取id，但是假如我们现在将User.java中的属性id的类型由Integer id 改为 String id，这样方法会立即报错，我们在其他地方使用的user.getId也会报错，这就是用内省机制来完成的，它有对这种类型检查的机制或事件监听的机制，若有变化自我感知从而发生改变。</p><h3 id="JavaBean是什么"><a href="#JavaBean是什么" class="headerlink" title="JavaBean是什么"></a>JavaBean是什么</h3><p><code>JavaBean</code>是一种特殊（其实说普通也可以，也不是十分特殊）的类，主要用于传递数据信息，这种类中的方法主要用于访问私有的字段，且方法名符合某种命名规则（字段都是私有，每个字段具备<code>Setter</code>和<code>Getter</code>方法，方法和字段命名满足首字母小写驼峰命名规则）。如果在两个模块之间传递信息，可以将信息封装进<code>JavaBean</code>中，这种对象称为值对象(<code>Value Object</code>)或者<code>VO</code>。这些信息储存在类的私有变量中，通过<code>Setter</code>、<code>Getter</code>方法获得。<code>JavaBean</code>的信息在<code>Introspector</code>里对应的概念是<code>BeanInfo</code>，它包含了<code>JavaBean</code>所有的<code>Descriptor</code>(描述符)，主要有<code>PropertyDescriptor</code>，<code>MethodDescriptor</code>(<code>MethodDescriptor</code>里面包含<code>ParameterDescriptor</code>)、<code>BeanDescriptor</code>和<code>EventSetDescriptor</code>。</p><h3 id="属性Field和属性描述PropertiesDescriptor的区别"><a href="#属性Field和属性描述PropertiesDescriptor的区别" class="headerlink" title="属性Field和属性描述PropertiesDescriptor的区别"></a>属性Field和属性描述PropertiesDescriptor的区别</h3><p>如果是严格的<code>JavaBean</code>(<code>Field</code>名称不重复，并且<code>Field</code>具备<code>Setter</code>和<code>Getter</code>方法)，它的<code>PropertyDescriptor</code>会通过解析<code>Setter</code>和<code>Getter</code>方法，合并解析结果，最终得到对应的<code>PropertyDescriptor</code>实例。所以<code>PropertyDescriptor</code>包含了属性名称和属性的<code>Setter</code>和<code>Getter</code>方法(如果存在的话)。</p><h3 id="内省Introspector和反射Reflection的区别"><a href="#内省Introspector和反射Reflection的区别" class="headerlink" title="内省Introspector和反射Reflection的区别"></a>内省Introspector和反射Reflection的区别</h3><ul><li><code>Reflection</code>：反射就是运行时获取一个类的所有信息，可以获取到类的所有定义的信息（包括成员变量，成员方法，构造器等）可以操纵类的字段、方法、构造器等部分。可以想象为镜面反射或者照镜子，这样的操作是带有客观色彩的，也就是反射获取到的类信息是必定正确的。</li><li><code>Introspector</code>：内省基于反射实现，主要用于操作<code>JavaBean</code>，基于<code>JavaBean</code>的规范进行<code>Bean</code>信息描述符的解析，依据于类的<code>Setter</code>和<code>Getter</code>方法，可以获取到类的描述符。可以想象为“自我反省”，这样的操作带有主观的色彩，不一定是正确的(如果一个类中的属性没有<code>Setter</code>和<code>Getter</code>方法，无法使用内省)。</li></ul><h1 id="内省常用API"><a href="#内省常用API" class="headerlink" title="内省常用API"></a>内省常用API</h1><p>内省涉及到的主要的类与接口如下：</p><ul><li><code>Introspector</code> 类: 提供标准的方式来获取Java Bean支持的属性，事件和方法等信息，它提供了的 <code>getBeanInfo</code> 系类方法，可以拿到一个 JavaBean 的所有信息。</li><li><code>BeanInfo</code> 接口: 定义了获取上述 Java Bean 信息的接口，通过 <code>BeanInfo</code> 的 <code>getPropertyDescriptors</code> 方法和 <code>getMethodDescriptors</code> 方法可以拿到 javaBean 的字段信息列表和 getter 和 setter 方法信息列表。</li><li><code>FeatureDescriptor</code>: 是 <code>PropertyDescriptor</code>、<code>EventSetDescriptor</code> 和 <code>MethodDescriptor</code> 等的公共基类，它支持一些可以设置和获取任意的内省描述符的公共信息。<ul><li><code>PropertyDescriptors</code> 可以根据字段直接获得该字段的 getter 和 setter 方法。</li><li><code>MethodDescriptors</code> 可以获得方法的元信息，比如方法名，参数个数，参数字段类型等。<br><img src="https://segmentfault.com/img/bVcT93c" alt="image.png" title="image.png"></li></ul></li></ul><p><img src="https://upload-images.jianshu.io/upload_images/4047674-2c6fc8660249f92d.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1200/format/webp"></p><p><code>FeatureDescriptor</code> 的主要属性有：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">// expert 标志当前的Descriptor是给专家使用还是普通用户使用</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> expert;</span><br><span class="line"><span class="comment">// hidden 标志当前的Descriptor是给工具使用还是普通用户使用，如果是给工具使用，则应该隐藏，返回true。</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> hidden;</span><br><span class="line"><span class="comment">// preferred 标志当前的Descriptor对普通用户很重要</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">boolean</span> preferred;</span><br><span class="line"><span class="comment">// 简要描述</span></span><br><span class="line"><span class="keyword">private</span> String shortDescription;</span><br><span class="line"><span class="comment">// 名字</span></span><br><span class="line"><span class="keyword">private</span> String name;</span><br><span class="line"><span class="comment">// 名字</span></span><br><span class="line"><span class="keyword">private</span> String displayName;</span><br><span class="line"><span class="comment">// 当前Descriptor 相关的属性</span></span><br><span class="line"><span class="keyword">private</span> Hashtable&lt;String, Object&gt; table;</span><br></pre></td></tr></table></figure><h2 id="Introspector"><a href="#Introspector" class="headerlink" title="Introspector"></a>Introspector</h2><p><code>Introspector</code>类似于<code>BeanInfo</code>的静态工厂类，主要是提供静态方法通过<code>Class</code>实例获取到<code>BeanInfo</code>，得到<code>BeanInfo</code>之后，就能够获取到其他描述符。主要方法：</p><ul><li><code>public static BeanInfo getBeanInfo(Class beanClass)</code>：通过<code>Class</code>实例获取到<code>BeanInfo</code>实例。</li></ul><h2 id="BeanInfo"><a href="#BeanInfo" class="headerlink" title="BeanInfo"></a>BeanInfo</h2><p><code>BeanInfo</code>是一个接口，具体实现是<code>GenericBeanInfo</code>，通过这个接口可以获取一个类的各种类型的描述符。主要方法：</p><ul><li><code>BeanDescriptor getBeanDescriptor()</code>：获取<code>JavaBean</code>描述符。</li><li><code>EventSetDescriptor[] getEventSetDescriptors()</code>：获取<code>JavaBean</code>的所有的<code>EventSetDescriptor</code>。</li><li><code>PropertyDescriptor[] getPropertyDescriptors()</code>：获取<code>JavaBean</code>的所有的<code>PropertyDescriptor</code>。</li><li><code>MethodDescriptor[] getMethodDescriptors()</code>：获取<code>JavaBean</code>的所有的<code>MethodDescriptor</code>。</li></ul><p>这里要注意一点，通过<code>BeanInfo#getPropertyDescriptors()</code>获取到的<code>PropertyDescriptor</code>数组中，除了<code>Bean</code>属性的之外，还会带有一个属性名为<code>class</code>的<code>PropertyDescriptor</code>实例，它的来源是<code>Class</code>的<code>getClass</code>方法，如果不需要这个属性那么最好判断后过滤。</p><h2 id="PropertyDescriptor"><a href="#PropertyDescriptor" class="headerlink" title="PropertyDescriptor"></a>PropertyDescriptor</h2><p><code>PropertyDescriptor</code>类表示<code>JavaBean</code>类通过存储器(<code>Setter</code>和<code>Getter</code>)导出一个属性，它应该是内省体系中最常见的类。主要方法：</p><ul><li><code>synchronized Class getPropertyType()</code>：获得属性的<code>Class</code>对象。</li><li><code>synchronized Method getReadMethod()</code>：获得用于读取属性值的方法；</li><li><code>synchronized Method getWriteMethod()</code>：获得用于写入属性值的方法。</li><li><code>int hashCode()</code>：获取对象的哈希值。</li><li><code>synchronized void setReadMethod(Method readMethod)</code>：设置用于读取属性(<code>Getter</code>)值的方法。</li><li><code>synchronized void setWriteMethod(Method writeMethod)</code>：设置用于写入属性值(<code>Setter</code>)的方法。</li></ul><p>举个例子：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Main</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        BeanInfo beanInfo = Introspector.getBeanInfo(Person.class);</span><br><span class="line">        PropertyDescriptor[] propertyDescriptors = beanInfo.getPropertyDescriptors();</span><br><span class="line">        <span class="keyword">for</span> (PropertyDescriptor propertyDescriptor : propertyDescriptors) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="string">&quot;class&quot;</span>.equals(propertyDescriptor.getName())) &#123;</span><br><span class="line">                System.out.println(propertyDescriptor.getName());</span><br><span class="line">                System.out.println(propertyDescriptor.getWriteMethod().getName());</span><br><span class="line">                System.out.println(propertyDescriptor.getReadMethod().getName());</span><br><span class="line">                System.out.println(<span class="string">&quot;=======================&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">private</span> Long id;</span><br><span class="line">        <span class="keyword">private</span> String name;</span><br><span class="line">        <span class="keyword">private</span> Integer age;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Long <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> id;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.id = id;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.name = name;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> age;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(Integer age)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.age = age;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">age</span><br><span class="line">setAge</span><br><span class="line">getAge</span><br><span class="line">=======================</span><br><span class="line">id</span><br><span class="line">setId</span><br><span class="line">getId</span><br><span class="line">=======================</span><br><span class="line">name</span><br><span class="line">setName</span><br><span class="line">getName</span><br><span class="line">=======================</span><br></pre></td></tr></table></figure><h2 id="不正当使用Introspector会导致内存溢出"><a href="#不正当使用Introspector会导致内存溢出" class="headerlink" title="不正当使用Introspector会导致内存溢出"></a>不正当使用Introspector会导致内存溢出</h2><p>如果框架或者程序用到了<code>JavaBeans Introspector</code>，那么就相当于启用了一个系统级别的缓存，这个缓存会存放一些曾加载并分析过的<code>Javabean</code>的引用，当<code>web</code>服务器关闭的时候，由于这个缓存中存放着这些<code>Javabean</code>的引用，所以垃圾回收器不能对<code>Web</code>容器中的<code>JavaBean</code>对象进行回收，导致内存越来越大。还有一点值得注意，清除<code>Introspector</code>缓存的唯一方式是刷新整个缓存缓冲区，这是因为<code>JDK</code>没法判断哪些是属于当前的应用的引用，所以刷新整个<code>Introspector</code>缓存缓冲区会导致把服务器的所有应用的<code>Introspector</code>缓存都删掉。<code>Spring</code>中提供的<code>org.springframework.web.util.IntrospectorCleanupListener</code>就是为了解决这个问题，它会在<code>Web</code>服务器停止的时候，清理一下这个<code>Introspector</code>缓存，使那些<code>Javabean</code>能被垃圾回收器正确回收。</p><p>也就是说<code>JDK</code>的<code>Introspector</code>缓存管理是有一定缺陷的。但是如果使用在<code>Spring</code>体系则不会出现这种问题，因为<code>Spring</code>把<code>Introspector</code>缓存的管理移交到<code>Spring</code>自身而不是<code>JDK</code>（或者在<code>Web</code>容器销毁后完全不管），在加载并分析完所有类之后，会针对类加载器对<code>Introspector</code>缓存进行清理，避免内存泄漏的问题，详情可以看<code>CachedIntrospectionResults</code>和<code>SpringBoot</code>刷新上下文的方法<code>AbstractApplicationContext#refresh()</code>中<code>finally</code>代码块中存在清理缓存的方法<code>AbstractApplicationContext#resetCommonCaches();</code>。但是有很多程序和框架在使用了<code>JavaBeans Introspector</code>之后，都没有进行清理工作，比如<code>Quartz、Struts</code>等，这类操作会成为内存泄漏的隐患。</p><h1 id="内省的使用方式"><a href="#内省的使用方式" class="headerlink" title="内省的使用方式"></a>内省的使用方式</h1><p>使用步骤：</p><ol><li>获取BeanInfo</li><li>获取Descriptor</li></ol><p>具体的示例如下：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IntrospectorExample</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            BeanInfo beanInfo = Introspector.getBeanInfo(Person.class);</span><br><span class="line"></span><br><span class="line">            BeanDescriptor beanDescriptor = beanInfo.getBeanDescriptor();</span><br><span class="line">            System.out.println(<span class="string">&quot;BeanName:&quot;</span> + beanDescriptor.getName());</span><br><span class="line"></span><br><span class="line">            PropertyDescriptor[] propertyDescriptors = beanInfo.getPropertyDescriptors();</span><br><span class="line">            <span class="keyword">for</span> (PropertyDescriptor propertyDescriptor : propertyDescriptors) &#123;</span><br><span class="line">                Object defaultValue = <span class="keyword">new</span> Object();</span><br><span class="line">                <span class="keyword">if</span> (propertyDescriptor.getPropertyType().equals(Integer.TYPE)) &#123;</span><br><span class="line">                    defaultValue = <span class="number">0</span>;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (propertyDescriptor.getPropertyType().equals(String.class)) &#123;</span><br><span class="line">                    defaultValue = <span class="string">&quot;Empty String&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                propertyDescriptor.setValue(<span class="string">&quot;default&quot;</span>, defaultValue);</span><br><span class="line">                System.out.println(<span class="string">&quot;name:&quot;</span> + propertyDescriptor.getName()</span><br><span class="line">                        + <span class="string">&quot;, displayName:&quot;</span> + propertyDescriptor.getDisplayName()</span><br><span class="line">                        + <span class="string">&quot;, type:&quot;</span> + propertyDescriptor.getPropertyType()</span><br><span class="line">                        + <span class="string">&quot;, isExpert: &quot;</span> + propertyDescriptor.isExpert()</span><br><span class="line">                        + <span class="string">&quot;, isConstrained: &quot;</span> + propertyDescriptor.isConstrained()</span><br><span class="line">                        + <span class="string">&quot;, isHidden: &quot;</span> + propertyDescriptor.isHidden()</span><br><span class="line">                        + <span class="string">&quot;, isPreferred: &quot;</span> + propertyDescriptor.isPreferred()</span><br><span class="line">                        + <span class="string">&quot;, isBound: &quot;</span> + propertyDescriptor.isBound()</span><br><span class="line">                        + <span class="string">&quot;, readMethod:&quot;</span> + propertyDescriptor.getReadMethod()</span><br><span class="line">                        + <span class="string">&quot;,writeMethod:&quot;</span> + propertyDescriptor.getWriteMethod()</span><br><span class="line">                        + <span class="string">&quot;, value:&quot;</span> + propertyDescriptor.getValue(<span class="string">&quot;default&quot;</span>));</span><br><span class="line">            &#125;</span><br><span class="line">            MethodDescriptor[] methodDescriptors = beanInfo.getMethodDescriptors();</span><br><span class="line">            <span class="keyword">for</span> (MethodDescriptor methodDescriptor : methodDescriptors) &#123;</span><br><span class="line">                System.out.print(<span class="string">&quot;methodName:&quot;</span> + methodDescriptor.getName()</span><br><span class="line">                        + <span class="string">&quot;, methodDisplayName:&quot;</span> + methodDescriptor.getDisplayName()</span><br><span class="line">                        + <span class="string">&quot;, method:&quot;</span> + methodDescriptor.getMethod());</span><br><span class="line"></span><br><span class="line">                ParameterDescriptor[] parameterDescriptors = methodDescriptor.getParameterDescriptors();</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">null</span> == parameterDescriptors) &#123;</span><br><span class="line">                    System.out.println();</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; parameterDescriptors.length; i++) &#123;</span><br><span class="line">                    System.out.print(<span class="string">&quot;, #&quot;</span> + i + <span class="string">&quot;paramName&quot;</span> + parameterDescriptors[i].getName() + <span class="string">&quot;, paramClass&quot;</span> + parameterDescriptors[i].getClass());</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">catch</span> (IntrospectionException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Introspector-1"><a href="#Introspector-1" class="headerlink" title="Introspector"></a>Introspector</h2><p><code>java.beans.Introspector</code>，即<code>内省</code>。它提供了一套标准的访问Java Bean的<code>属性</code>，<code>事件</code>以及<code>方法</code>的处理方法。 对于Java Bean的这3种信息，Introspector会分析Java Bean以及它的父类的显示和隐式的信息，然后构建一个全面描述此Java Bean的<code>BeanInfo</code>对象。</p><p>在Java中，JavaBean是一种特殊的类，主要用于传递数据信息，这种类中的方法主要用于访问私有的属性，且方法名符合某种命名规则。例如DTO，VO等，我们在业务或者模块之间传递信息，可以将信息封装到JavaBean中。</p><p>既然封装到JavaBean中，那就会有设置（setter）和读取（getter）JavaBean中私有属性等操作。Introspector可以帮我们做到这件事，不过要注意，<code>JavaBean中的getter和setter等方法要遵循某种规范。（驼峰规则）</code></p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> age;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String id, String name, <span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setId</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.id = id;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setName</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IntrospectionException </span>&#123;</span><br><span class="line">        <span class="comment">// 不内省父类的信息,第二个参数stopClass代表从stopClass开始往上的父类不再内省</span></span><br><span class="line">        BeanInfo beanInfo = Introspector.getBeanInfo(Person.class, Object.class);</span><br><span class="line">        <span class="comment">// 会内省起所有父类的信息</span></span><br><span class="line">        BeanInfo includeParentBeanInfo = Introspector.getBeanInfo(Person.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="BeanInfo-1"><a href="#BeanInfo-1" class="headerlink" title="BeanInfo"></a>BeanInfo</h2><p><code>java.beans.BeanInfo</code>是一个接口，它有几个默认的实现类，我们一般默认生成的BeanInfo对象其实是GenericBeanInfo类的实例。简而言之，BeanInfo对象能提供关于JavaBean的方法，属性，事件以及其他特征的明确信息。 其主要方法如下：</p><ul><li>getPropertyDescriptors()：获得所有属性描述器。</li><li>getBeanDescriptor()：获得对象描述器。</li><li>getMethodDescriptors()：获得所有方法描述器。</li><li>getEventSetDescriptors()：获得所有事件描述器。</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IntrospectionException </span>&#123;</span><br><span class="line">        <span class="comment">// 不内省父类的信息,第二个参数stopClass代表从stopClass开始往上的父类不再内省</span></span><br><span class="line">        BeanInfo beanInfo = Introspector.getBeanInfo(Person.class, Object.class);</span><br><span class="line">        BeanDescriptor beanDescriptor = beanInfo.getBeanDescriptor();</span><br><span class="line">        PropertyDescriptor[] propertyDescriptors = beanInfo.getPropertyDescriptors();</span><br><span class="line">        MethodDescriptor[] methodDescriptors = beanInfo.getMethodDescriptors();</span><br><span class="line">        EventSetDescriptor[] eventSetDescriptors = beanInfo.getEventSetDescriptors();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="BeanDescriptor"><a href="#BeanDescriptor" class="headerlink" title="BeanDescriptor"></a>BeanDescriptor</h2><p><code>java.beans.BeanDescriptor</code>，即<code>对象描述器</code>。它提供了一个JavaBean的全局信息，例如JavaBean的类型，类名等信息。</p><p>我们一般是从BeanInfo对象获取BeanDescriptor对象，不过也可以直接通过new BeanDescriptor(Class beanClass)构造函数获取。</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IntrospectionException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 不内省父类的信息,第二个参数stopClass代表从stopClass开始往上的父类不再内省</span></span><br><span class="line">        BeanInfo beanInfo = Introspector.getBeanInfo(Person.class, Object.class);</span><br><span class="line">        <span class="comment">// 从BeanInfo对象获取BeanDescriptor对象</span></span><br><span class="line">        BeanDescriptor beanDescriptor = beanInfo.getBeanDescriptor();</span><br><span class="line">        <span class="comment">// 通过new BeanDescriptor(Class&lt;?&gt; beanClass)构造函数获取BeanDescriptor对象</span></span><br><span class="line">        <span class="comment">// BeanDescriptor beanDescriptor = new BeanDescriptor(Person.class);</span></span><br><span class="line"></span><br><span class="line">        Class&lt;?&gt; beanClass = beanDescriptor.getBeanClass();</span><br><span class="line">        Class&lt;?&gt; customizerClass = beanDescriptor.getCustomizerClass();</span><br><span class="line">        String displayName = beanDescriptor.getDisplayName();</span><br><span class="line">        String name = beanDescriptor.getName();</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;beanClass:&quot;</span> + beanClass);</span><br><span class="line">        System.out.println(<span class="string">&quot;customizerClass:&quot;</span> + customizerClass);</span><br><span class="line">        System.out.println(<span class="string">&quot;displayName:&quot;</span> + displayName);</span><br><span class="line">        System.out.println(<span class="string">&quot;name:&quot;</span> + name);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        PropertyDescriptor[] propertyDescriptors = beanInfo.getPropertyDescriptors();</span><br><span class="line">        MethodDescriptor[] methodDescriptors = beanInfo.getMethodDescriptors();</span><br><span class="line">        EventSetDescriptor[] eventSetDescriptors = beanInfo.getEventSetDescriptors();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果如下：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">beanClass:class com.nobody.Person</span><br><span class="line">customizerClass:null</span><br><span class="line">displayName:Person</span><br><span class="line">name:Person</span><br></pre></td></tr></table></figure><h2 id="PropertyDescriptor-1"><a href="#PropertyDescriptor-1" class="headerlink" title="PropertyDescriptor"></a>PropertyDescriptor</h2><p><code>java.beans.PropertyDescriptor</code>，即<code>属性描述器</code>。描述了Java Bean的一个属性，通过一对读取方法。即PropertyDescriptor里面封装了JavaBean的其中一个属性的相关信息（例如属性名，属性类型，get和set等方法）。其主要方法如下：</p><ul><li>getName()：获得属性名。</li><li>getPropertyType()：获得属性类型。</li><li>getReadMethod()：获得用于读取属性值的方法。</li><li>getWriteMethod()：获得用于写入属性值的方法。</li><li>setReadMethod(Method readMethod)：设置用于读取属性值的方法。</li><li>setWriteMethod(Method writeMethod)：设置用于写入属性值的方法。</li></ul><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> IntrospectionException, InvocationTargetException, IllegalAccessException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 不内省父类的信息,第二个参数stopClass代表从stopClass开始往上的父类不再内省</span></span><br><span class="line">        BeanInfo beanInfo = Introspector.getBeanInfo(Person.class, Object.class);</span><br><span class="line"></span><br><span class="line">        Person person = <span class="keyword">new</span> Person(UUID.randomUUID().toString(), <span class="string">&quot;Mr_nobody&quot;</span>, <span class="number">18</span>);</span><br><span class="line"></span><br><span class="line">        PropertyDescriptor[] propertyDescriptors = beanInfo.getPropertyDescriptors();</span><br><span class="line">        <span class="keyword">for</span> (PropertyDescriptor propertyDescriptor : propertyDescriptors) &#123;</span><br><span class="line">            Class&lt;?&gt; propertyType = propertyDescriptor.getPropertyType();</span><br><span class="line">            String propertyName = propertyDescriptor.getName();</span><br><span class="line">            Method readMethod = propertyDescriptor.getReadMethod();</span><br><span class="line">            Method writeMethod = propertyDescriptor.getWriteMethod();</span><br><span class="line"></span><br><span class="line">            System.out.println(<span class="string">&quot;属性名：&quot;</span> + propertyName);</span><br><span class="line">            System.out.println(<span class="string">&quot;属性类型：&quot;</span> + propertyType);</span><br><span class="line">            System.out.println(<span class="string">&quot;写方法名：&quot;</span> + writeMethod.getName());</span><br><span class="line">            System.out.println(<span class="string">&quot;读方法名：&quot;</span> + readMethod.getName());</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="string">&quot;age&quot;</span>.equals(propertyName)) &#123;</span><br><span class="line">                writeMethod.invoke(person, <span class="number">20</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(<span class="string">&quot;属性值：&quot;</span> + readMethod.invoke(person));</span><br><span class="line">            System.out.println(<span class="string">&quot;------------------------------------------&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果：</p><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">属性名：age</span><br><span class="line">属性类型：int</span><br><span class="line">写方法名：setAge</span><br><span class="line">读方法名：getAge</span><br><span class="line">属性值：20</span><br><span class="line">------------------------------------------</span><br><span class="line">属性名：id</span><br><span class="line">属性类型：class java.lang.String</span><br><span class="line">写方法名：setId</span><br><span class="line">读方法名：getId</span><br><span class="line">属性值：a6ccda55-c895-438e-893f-7fa448aba35a</span><br><span class="line">------------------------------------------</span><br><span class="line">属性名：name</span><br><span class="line">属性类型：class java.lang.String</span><br><span class="line">写方法名：setName</span><br><span class="line">读方法名：getName</span><br><span class="line">属性值：Mr_nobody</span><br><span class="line">------------------------------------------</span><br></pre></td></tr></table></figure><p>当然，除了从BeanInfo对象获取PropertyDescriptor对象，也可以直接new的方式获取。</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line">PropertyDescriptor namePropertyDescriptor = <span class="keyword">new</span> PropertyDescriptor(<span class="string">&quot;name&quot;</span>, Person.class);</span><br></pre></td></tr></table></figure><h2 id="MethodDescriptor"><a href="#MethodDescriptor" class="headerlink" title="MethodDescriptor"></a>MethodDescriptor</h2><p>java.beans.MethodDescriptor，即方法描述器，通过它可以获取到类相关的方法，如下所示：</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Demo</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> IntrospectionException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 不内省父类的信息,第二个参数stopClass代表从stopClass开始往上的父类不再内省</span></span><br><span class="line">        BeanInfo beanInfo = Introspector.getBeanInfo(Person.class, Object.class);</span><br><span class="line"></span><br><span class="line">        MethodDescriptor[] methodDescriptors = beanInfo.getMethodDescriptors();</span><br><span class="line">        <span class="keyword">for</span> (MethodDescriptor methodDescriptor : methodDescriptors) &#123;</span><br><span class="line"></span><br><span class="line">            Method method = methodDescriptor.getMethod();</span><br><span class="line">            System.out.println(method);</span><br><span class="line">            System.out.println(<span class="string">&quot;方法名：&quot;</span> + method.getName());</span><br><span class="line"></span><br><span class="line">            Type[] genericParameterTypes = method.getGenericParameterTypes();</span><br><span class="line">            <span class="keyword">if</span> (genericParameterTypes != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (Type genericParameterType : genericParameterTypes) &#123;</span><br><span class="line">                    System.out.println(<span class="string">&quot;方法参数类型：&quot;</span> + genericParameterType.getTypeName());</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            Class&lt;?&gt; returnType = method.getReturnType();</span><br><span class="line">            System.out.println(<span class="string">&quot;方法返回类型：&quot;</span> + returnType.getTypeName());</span><br><span class="line">            System.out.println(<span class="string">&quot;---------------------------&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>输出结果如下：</p><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">public java.lang.String com.nobody.Person.getName()</span><br><span class="line">方法名：getName</span><br><span class="line">方法返回类型：java.lang.String</span><br><span class="line">---------------------------</span><br><span class="line">public void com.nobody.Person.setId(java.lang.String)</span><br><span class="line">方法名：setId</span><br><span class="line">方法参数类型：java.lang.String</span><br><span class="line">方法返回类型：void</span><br><span class="line">---------------------------</span><br><span class="line">public void com.nobody.Person.setAge(int)</span><br><span class="line">方法名：setAge</span><br><span class="line">方法参数类型：int</span><br><span class="line">方法返回类型：void</span><br><span class="line">---------------------------</span><br><span class="line">public void com.nobody.Person.setName(java.lang.String)</span><br><span class="line">方法名：setName</span><br><span class="line">方法参数类型：java.lang.String</span><br><span class="line">方法返回类型：void</span><br><span class="line">---------------------------</span><br><span class="line">public int com.nobody.Person.getAge()</span><br><span class="line">方法名：getAge</span><br><span class="line">方法返回类型：int</span><br><span class="line">---------------------------</span><br><span class="line">public java.lang.String com.nobody.Person.getId()</span><br><span class="line">方法名：getId</span><br><span class="line">方法返回类型：java.lang.String</span><br><span class="line">---------------------------</span><br><span class="line">public java.lang.String com.nobody.Person.toString()</span><br><span class="line">方法名：toString</span><br><span class="line">方法返回类型：java.lang.String</span><br><span class="line">---------------------------</span><br></pre></td></tr></table></figure><h2 id="内省应用"><a href="#内省应用" class="headerlink" title="内省应用"></a>内省应用</h2><p>在项目实战中，我们一般使用最多的是 <code>Introspector</code>，<code>BeanInfo</code>，<code>PropertyDescriptor</code>，这三者结合起来使用。</p><p>比如，我们通过内省可以实现，JavaBean和Map互转，不同JavaBean对象属性拷贝等功能。</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BeanUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">Map&lt;String, Object&gt; <span class="title">beanToMap</span><span class="params">(T bean, <span class="keyword">boolean</span> putIfNull)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> IntrospectionException, InvocationTargetException, IllegalAccessException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (bean == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        Map&lt;String, Object&gt; returnMap = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取bean的BeanInfo对象</span></span><br><span class="line">        BeanInfo beanInfo = Introspector.getBeanInfo(bean.getClass(), Object.class);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取属性描述器</span></span><br><span class="line">        PropertyDescriptor[] propertyDescriptors = beanInfo.getPropertyDescriptors();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (PropertyDescriptor propertyDescriptor : propertyDescriptors) &#123;</span><br><span class="line">            <span class="comment">// 属性名</span></span><br><span class="line">            String propertyName = propertyDescriptor.getName();</span><br><span class="line">            <span class="comment">// 获取该属性的值</span></span><br><span class="line">            Method readMethod = propertyDescriptor.getReadMethod();</span><br><span class="line">            <span class="comment">// 属性的值</span></span><br><span class="line">            Object value = readMethod.invoke(bean);</span><br><span class="line">            <span class="keyword">if</span> (value == <span class="keyword">null</span> &amp;&amp; !putIfNull) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            returnMap.put(propertyName, value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> returnMap;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; List&lt;Map&lt;String, Object&gt;&gt; beansToMaps(List&lt;T&gt; beans, <span class="keyword">boolean</span> putIfNull)</span><br><span class="line">            <span class="keyword">throws</span> IllegalAccessException, IntrospectionException, InvocationTargetException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == beans || beans.size() == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        List&lt;Map&lt;String, Object&gt;&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;(beans.size() + <span class="number">1</span>);</span><br><span class="line">        <span class="comment">// 转换每一个bean</span></span><br><span class="line">        <span class="keyword">for</span> (Object bean : beans) &#123;</span><br><span class="line">            result.add(beanToMap(bean, putIfNull));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">T <span class="title">mapToBean</span><span class="params">(Map&lt;String, Object&gt; map, Class&lt;T&gt; clz)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> IllegalAccessException, InstantiationException, IntrospectionException,</span></span><br><span class="line"><span class="function">            InvocationTargetException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 生成bean实例</span></span><br><span class="line">        T bean = clz.newInstance();</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == map) &#123;</span><br><span class="line">            <span class="keyword">return</span> bean;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        BeanInfo beanInfo = Introspector.getBeanInfo(clz, Object.class);</span><br><span class="line">        PropertyDescriptor[] propertyDescriptors = beanInfo.getPropertyDescriptors();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (PropertyDescriptor propertyDescriptor : propertyDescriptors) &#123;</span><br><span class="line">            <span class="comment">// 属性名</span></span><br><span class="line">            String propertyName = propertyDescriptor.getName();</span><br><span class="line">            <span class="comment">// 获取属性值</span></span><br><span class="line">            Object value = map.get(propertyName);</span><br><span class="line">            <span class="comment">// 写入属性值</span></span><br><span class="line">            Method writeMethod = propertyDescriptor.getWriteMethod();</span><br><span class="line">            writeMethod.invoke(bean, value);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> bean;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function">List&lt;T&gt; <span class="title">mapsToBeans</span><span class="params">(List&lt;Map&lt;String, Object&gt;&gt; maps, Class&lt;T&gt; clz)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> InvocationTargetException, IntrospectionException, InstantiationException,</span></span><br><span class="line"><span class="function">            IllegalAccessException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == maps || maps.size() == <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        List&lt;T&gt; result = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Map&lt;String, Object&gt; map : maps) &#123;</span><br><span class="line">            result.add(mapToBean(map, clz));</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T1, T2&gt; <span class="function"><span class="keyword">void</span> <span class="title">copyProperties</span><span class="params">(T1 origin, T2 dest, <span class="keyword">boolean</span> setNull,</span></span></span><br><span class="line"><span class="params"><span class="function">            String[] excludeFieldNames)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> IntrospectionException, InvocationTargetException, IllegalAccessException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取源类的BeanInfo对象</span></span><br><span class="line">        BeanInfo originBeanInfo = Introspector.getBeanInfo(origin.getClass(), Object.class);</span><br><span class="line">        <span class="comment">// 获取源类的属性描述器</span></span><br><span class="line">        PropertyDescriptor[] originPropertyDescriptors = originBeanInfo.getPropertyDescriptors();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取目标类的BeanInfo对象</span></span><br><span class="line">        BeanInfo destBeanInfo = Introspector.getBeanInfo(dest.getClass(), Object.class);</span><br><span class="line">        <span class="comment">// 获取目标类的属性描述器</span></span><br><span class="line">        PropertyDescriptor[] destPropertyDescriptors = destBeanInfo.getPropertyDescriptors();</span><br><span class="line">        <span class="keyword">for</span> (PropertyDescriptor propertyDescriptor : destPropertyDescriptors) &#123;</span><br><span class="line">            String propertyName = propertyDescriptor.getName();</span><br><span class="line">            <span class="comment">// 是否需要排除的属性</span></span><br><span class="line">            <span class="keyword">boolean</span> excludeField = <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">if</span> (excludeFieldNames != <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">for</span> (String excludeFieldName : excludeFieldNames) &#123;</span><br><span class="line">                    <span class="keyword">if</span> (Objects.equals(excludeFieldName, propertyName)) &#123;</span><br><span class="line">                        excludeField = <span class="keyword">true</span>;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (excludeField) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 遍历源类的所有属性，如果存在此属性则进行拷贝</span></span><br><span class="line">            <span class="keyword">for</span> (PropertyDescriptor originPropertyDescriptor : originPropertyDescriptors) &#123;</span><br><span class="line">                String originPropertyName = originPropertyDescriptor.getName();</span><br><span class="line">                <span class="keyword">if</span> (Objects.equals(propertyName, originPropertyName)) &#123;</span><br><span class="line">                    <span class="comment">// 读取属性值</span></span><br><span class="line">                    Method readMethod = originPropertyDescriptor.getReadMethod();</span><br><span class="line">                    Object srcValue = readMethod.invoke(origin);</span><br><span class="line">                    <span class="keyword">if</span> (srcValue != <span class="keyword">null</span> || setNull) &#123;</span><br><span class="line">                        <span class="comment">// 设置属性值</span></span><br><span class="line">                        Method writeMethod = propertyDescriptor.getWriteMethod();</span><br><span class="line">                        writeMethod.invoke(dest, srcValue);</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T1, T2&gt; <span class="function"><span class="keyword">void</span> <span class="title">copyProperties</span><span class="params">(T1 origin, T2 dest)</span></span></span><br><span class="line"><span class="function">            <span class="keyword">throws</span> IllegalAccessException, IntrospectionException, InvocationTargetException </span>&#123;</span><br><span class="line">        copyProperties(origin, dest, <span class="keyword">false</span>, <span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>以上是我们手写的JavaBean相关的转换工具类，当然市场上已经有很多成熟的工具包了，例如Apache的commons-beanutils包，里面就提供了许多实际开发中的应用场景会用到的API，大家不妨可以试用看看。</p><blockquote><p><strong>注意事项：</strong><br>开头提到JavaBean的get/set方法名要遵循某种规则，即驼峰规则。如果，我们将某个属性的get方法换个名字，例如将id属性的get方法名改为getUid()。那么我们就获取不到属性id的读方法的，即取到的是null。因为在取得id这个属性的属性描述器时，我们获取到了属性名，但是因为get方法没有遵循规则，所以调用<code>getReadMethod()</code>获取不到方法，所以出现空指针。</p></blockquote><h1 id="反射与内省的区别"><a href="#反射与内省的区别" class="headerlink" title="反射与内省的区别"></a>反射与内省的区别</h1><ul><li>内省操作只针对JavaBean，只有符合JavaBean规则的类的成员才可以采用内省API进行操作，而反射则不同，一个类的所有成员都可以进行反射操作。</li><li>内省和反射的操作也有很大不同，内省是先得到属性描述器PropertyDecriptor后再进行各种操作，反射则是先得到类的字节码Class后再进行各种操作的。</li></ul><p><strong>Java的内省最终是用Java的反射实现的。那为什么不直接用反射，要使用内省呢？</strong></p><h2 id="使用内省替代直接使用反射可以防止破坏类的封装"><a href="#使用内省替代直接使用反射可以防止破坏类的封装" class="headerlink" title="使用内省替代直接使用反射可以防止破坏类的封装"></a>使用内省替代直接使用反射可以防止破坏类的封装</h2><p>我们定义一个人的类型，其中包括年龄和是否成年两个属性。在修改年龄属性的时候会同时修改是否成年的属性。我们假设18岁和18岁以上就是成年，否则就是未成年。</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.beans.IntrospectionException;</span><br><span class="line"><span class="keyword">import</span> java.beans.PropertyDescriptor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.text.MessageFormat;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 18岁成年</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> ADULT_AGE = <span class="number">18</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 年龄</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>     age;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 是否成年</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> adult;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.adult = age &gt;= ADULT_AGE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isAdult</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> adult;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> MessageFormat.format(<span class="string">&quot;age：&#123;0&#125;，adult：&#123;1&#125;&quot;</span>, age, adult);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 利用反射修改对象属性</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> o</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fieldName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NoSuchFieldException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalAccessException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">changeObjectFieldByReflection</span><span class="params">(Object o, String fieldName, Object value)</span> <span class="keyword">throws</span> NoSuchFieldException, IllegalAccessException </span>&#123;</span><br><span class="line">        Field field = o.getClass().getDeclaredField(fieldName);</span><br><span class="line">        field.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        field.set(o, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 利用内省修改对象属性</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> o</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> fieldName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> NoSuchFieldException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalAccessException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">changeObjectFieldByIntrospector</span><span class="params">(Object o, String fieldName, Object value)</span> <span class="keyword">throws</span> IntrospectionException, InvocationTargetException, IllegalAccessException </span>&#123;</span><br><span class="line">        PropertyDescriptor pd = <span class="keyword">new</span> PropertyDescriptor(fieldName, o.getClass());</span><br><span class="line">        pd.getWriteMethod().invoke(o, value);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchFieldException, IllegalAccessException, IntrospectionException, InvocationTargetException </span>&#123;</span><br><span class="line">        Person p = <span class="keyword">new</span> Person();</span><br><span class="line">        changeObjectFieldByReflection(p, <span class="string">&quot;age&quot;</span>, <span class="number">20</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;反射修改属性破坏类的封装，使其内部状态错误：&quot;</span>);</span><br><span class="line">        System.out.println(p);</span><br><span class="line"></span><br><span class="line">        changeObjectFieldByIntrospector(p, <span class="string">&quot;age&quot;</span>, <span class="number">18</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;内省修改属性未破坏类的封装：&quot;</span>);</span><br><span class="line">        System.out.println(p);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210712163242625.png" alt="在这里插入图片描述" title="在这里插入图片描述"></p><p>可以看到，反射由于是直接修改属性，所以破坏了类中封装的逻辑(20岁却不是成年)。</p><p>而内省由于修改属性还是调用了set方法，也就是说和正常修改对象属性调用了相同的方法，所以类的封装性不会遭到破坏。</p><p>当然由于内省其实本质也是反射，可以说是封装了反射，所以如果反射用的正确，也是安全的，我们可以根据属性名去获取相应的set和get方法，然后再去调用，但是这种情况下内省使用起来就更方便，毕竟没有必要重复发明一个车轮子，圆形轮子已经是很多年很多年智慧的结晶了。</p><p>那么问题来了，既然内省就是调用set和get方法，那我为什么不直接调用set和get方法，而要使用内省呢？</p><h2 id="使用内省也一样可以写出通用的工具"><a href="#使用内省也一样可以写出通用的工具" class="headerlink" title="使用内省也一样可以写出通用的工具"></a>使用内省也一样可以写出通用的工具</h2><p>既然内省可以动态获取信息，那就和反射一样，可以实现出通用工具或者框架哦。我们这里实现一个可以拷贝任意类型两个对象的属性值的工具方法。</p><figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> java.beans.BeanInfo;</span><br><span class="line"><span class="keyword">import</span> java.beans.IntrospectionException;</span><br><span class="line"><span class="keyword">import</span> java.beans.Introspector;</span><br><span class="line"><span class="keyword">import</span> java.beans.PropertyDescriptor;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.InvocationTargetException;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Method;</span><br><span class="line"><span class="keyword">import</span> java.text.MessageFormat;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Person</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 18岁成年</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> ADULT_AGE = <span class="number">18</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 名字</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> String  name;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 身高</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span>       <span class="keyword">int</span>     height;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 年龄</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span>       <span class="keyword">int</span>     age;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 是否成年</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span>       <span class="keyword">boolean</span> adult;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Person</span><span class="params">(String name)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.name = name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getName</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> name;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getHeight</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setHeight</span><span class="params">(<span class="keyword">int</span> height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.height = height;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getAge</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> age;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setAge</span><span class="params">(<span class="keyword">int</span> age)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.age = age;</span><br><span class="line">        <span class="keyword">this</span>.adult = age &gt;= ADULT_AGE;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isAdult</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> adult;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> MessageFormat.format(<span class="string">&quot;name：&#123;0&#125;，height：&#123;1&#125;，age：&#123;2&#125;，adult：&#123;3&#125;&quot;</span>, name, height, age, adult);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 测试</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 将orig的可读属性值拷贝到dest的可写属性中</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> dest</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> orig</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> &lt;T&gt;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IntrospectionException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> InvocationTargetException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IllegalAccessException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; <span class="function"><span class="keyword">void</span> <span class="title">copyProperties</span><span class="params">(T dest, T orig)</span> <span class="keyword">throws</span> IntrospectionException, InvocationTargetException, IllegalAccessException </span>&#123;</span><br><span class="line">        BeanInfo beanInfo = Introspector.getBeanInfo(orig.getClass());</span><br><span class="line">        PropertyDescriptor[] pds = beanInfo.getPropertyDescriptors();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (PropertyDescriptor pd : pds) &#123;</span><br><span class="line">            Method rm = pd.getReadMethod();</span><br><span class="line">            Method wm = pd.getWriteMethod();</span><br><span class="line">            <span class="keyword">if</span> (rm != <span class="keyword">null</span></span><br><span class="line">                &amp;&amp; wm != <span class="keyword">null</span>) &#123;</span><br><span class="line">                Object value = rm.invoke(orig);</span><br><span class="line">                wm.invoke(dest, value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> NoSuchFieldException, IllegalAccessException, IntrospectionException, InvocationTargetException </span>&#123;</span><br><span class="line">        Person p2 = <span class="keyword">new</span> Person(<span class="string">&quot;二当家的&quot;</span>);</span><br><span class="line">        p2.setAge(<span class="number">18</span>);</span><br><span class="line">        p2.setHeight(<span class="number">180</span>);</span><br><span class="line">        System.out.println(p2);</span><br><span class="line"></span><br><span class="line">        Person p1 = <span class="keyword">new</span> Person(<span class="string">&quot;大当家的&quot;</span>);</span><br><span class="line">        System.out.println(p1);</span><br><span class="line"></span><br><span class="line">        System.out.println(<span class="string">&quot;将二当家的可读属性值拷贝给大当家的可写属性：&quot;</span>);</span><br><span class="line">        copyProperties(p1, p2);</span><br><span class="line">        System.out.println(p1);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="https://img-blog.csdnimg.cn/20210712172557375.png" alt="在这里插入图片描述" title="在这里插入图片描述"></p><p>可以看到，名字没有被拷贝，其他的属性值都顺利拷贝了。这也是我们期望的结果。</p><p>内省很好的保证了类的封装性，同时又具有动态获取对象属性，和动态修改对象属性的能力。</p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><ul><li>在标准的<code>JavaBean</code>中，可以考虑使用<code>Introspector</code>体系解析<code>JavaBean</code>，主要是方便使用反射之前的时候快速获取到<code>JavaBean</code>的<code>Setter</code>和<code>Getter</code>方法。</li><li>在<code>Spring</code>体系中，为了防止<code>JDK</code>对内省信息的缓存无法被垃圾回收机制回收导致内存溢出，主要的操作除了可以通过配置<code>IntrospectorCleanupListener</code>预防，还有另外一种方式，就是通过<code>CachedIntrospectionResults</code>类自行管理<code>Introspector</code>中的缓存(这种方式才是优雅的方式，这样可以避免刷新整个<code>Introspector</code>的缓存缓冲区而导致其他应用的<code>Introspector</code>也被清空)，<strong>也就是把Jdk自行管理的Introspector相关缓存交给Spring自己去管理</strong>。在<code>SpringBoot</code>刷新上下文的方法<code>AbstractApplicationContext#refresh()</code>中finally代码块中存在清理缓存的方法<code>AbstractApplicationContext#resetCommonCaches();</code>，里面调用到的<code>CachedIntrospectionResults#clearClassLoader(getClassLoader())</code>方法就是清理指定的<code>ClassLoader</code>下的所有<code>Introspector</code>中的缓存的引用。</li></ul><blockquote><p>参考文章：<br><a target="_blank" rel="noopener" href="https://mp.weixin.qq.com/s/FAYHhBr6jC6RMBbFyW5D2g">聊聊Java内省Introspector (qq.com)</a><br><a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/359284593">大多数人不知道的Java知识 - Java内省机制 - 知乎 (zhihu.com)</a><br><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000040517537">Java的反射(Reflection)和内省(IntroSpector)机制 - SegmentFault 思否</a><br><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/854723">java的反射用不好容易走火入魔？还可以用内省啊！-阿里云开发者社区 (aliyun.com)</a></p></blockquote></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">空白格</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://lemon-cs.github.io/2020/07/18/Java%E5%86%85%E7%9C%81%E6%9C%BA%E5%88%B6/">https://lemon-cs.github.io/2020/07/18/Java%E5%86%85%E7%9C%81%E6%9C%BA%E5%88%B6/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://lemon-cs.github.io" target="_blank">Lemon-CS</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/Java/">Java</a><a class="post-meta__tags" href="/tags/%E5%86%85%E7%9C%81/">内省</a></div><div class="post_share"><div class="social-share" data-image="https://static01.imgkr.com/temp/67e21ea4f0cb464cb52de4d60aad3962.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2020/07/19/MyBatis%E4%B9%8B%E6%B3%A8%E8%A7%A3%E5%BC%80%E5%8F%91/"><img class="prev-cover" src="https://static01.imgkr.com/temp/67e21ea4f0cb464cb52de4d60aad3962.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">MyBatis之注解开发-6</div></div></a></div><div class="next-post pull-right"><a href="/2020/07/18/MyBatis%E4%B9%8B%E5%A4%8D%E6%9D%82%E6%98%A0%E5%B0%84%E5%BC%80%E5%8F%91/"><img class="next-cover" src="https://s4.ax1x.com/2022/02/15/HRptqP.png" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">MyBatis之复杂映射开发-5</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2020/05/11/BIONIOAIO/" title="BIO-NIO-AIO"><img class="cover" src="https://s3.bmp.ovh/imgs/2021/12/8ceea24ac1259251.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-05-11</div><div class="title">BIO-NIO-AIO</div></div></a></div><div><a href="/2020/03/11/Java%E4%B9%8BIO/" title="Java之IO"><img class="cover" src="https://s4.ax1x.com/2022/02/15/HRSa9J.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-11</div><div class="title">Java之IO</div></div></a></div><div><a href="/2020/04/02/Java%E4%B9%8BOptional%E4%BD%BF%E7%94%A8/" title="Java之Optional使用"><img class="cover" src="https://s3.bmp.ovh/imgs/2021/12/468eb316ff103180.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-04-02</div><div class="title">Java之Optional使用</div></div></a></div><div><a href="/2020/02/29/Java%E4%B8%8ESpring%E6%B3%A8%E8%A7%A3%E7%AF%87/" title="Java与Spring注解篇"><img class="cover" src="https://s3.bmp.ovh/imgs/2022/01/21be22e888bfda1d.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-02-29</div><div class="title">Java与Spring注解篇</div></div></a></div><div><a href="/2020/03/27/Java%E5%87%BD%E6%95%B0%E5%BC%8F%E7%BC%96%E7%A8%8B/" title="Java函数式编程"><img class="cover" src="https://s4.ax1x.com/2022/02/15/HRpEvR.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-03-27</div><div class="title">Java函数式编程</div></div></a></div><div><a href="/2020/07/01/Java%E5%8F%8D%E5%B0%84/" title="Java反射"><img class="cover" src="https://static01.imgkr.com/temp/31d9be0ee4fc43549ffe1bd007bc4e59.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-07-01</div><div class="title">Java反射</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="lv-container" data-id="city" data-uid="MTAyMC81NTAxNC8zMTQ4Mg=="></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/./images/avatar.png" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">空白格</div><div class="author-info__description">杯中的水是亮闪闪的,海里的水是黑沉沉的!</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">77</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">标签</div><div class="length-num">72</div></a></div><div class="card-info-data-item is-center"><a href="/categories/"><div class="headline">分类</div><div class="length-num">14</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/Lemon-CS"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/Lemon-CS" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:591930734@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>公告</span></div><div class="announcement_content">欢迎来到Lemon-CS</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5"><span class="toc-text">基本概念</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Java%E5%8F%8D%E5%B0%84%E6%9C%BA%E5%88%B6"><span class="toc-text">Java反射机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Java%E5%86%85%E7%9C%81%E6%9C%BA%E5%88%B6"><span class="toc-text">Java内省机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Java%E7%9A%84%E5%86%85%E7%9C%81%E6%9C%BA%E5%88%B6%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">Java的内省机制是什么？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E7%9C%81-Introspector"><span class="toc-text">内省(Introspector)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#JavaBean%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-text">JavaBean是什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7Field%E5%92%8C%E5%B1%9E%E6%80%A7%E6%8F%8F%E8%BF%B0PropertiesDescriptor%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">属性Field和属性描述PropertiesDescriptor的区别</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E7%9C%81Introspector%E5%92%8C%E5%8F%8D%E5%B0%84Reflection%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">内省Introspector和反射Reflection的区别</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%85%E7%9C%81%E5%B8%B8%E7%94%A8API"><span class="toc-text">内省常用API</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introspector"><span class="toc-text">Introspector</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanInfo"><span class="toc-text">BeanInfo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PropertyDescriptor"><span class="toc-text">PropertyDescriptor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8D%E6%AD%A3%E5%BD%93%E4%BD%BF%E7%94%A8Introspector%E4%BC%9A%E5%AF%BC%E8%87%B4%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA"><span class="toc-text">不正当使用Introspector会导致内存溢出</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%85%E7%9C%81%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F"><span class="toc-text">内省的使用方式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introspector-1"><span class="toc-text">Introspector</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanInfo-1"><span class="toc-text">BeanInfo</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#BeanDescriptor"><span class="toc-text">BeanDescriptor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PropertyDescriptor-1"><span class="toc-text">PropertyDescriptor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#MethodDescriptor"><span class="toc-text">MethodDescriptor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%9C%81%E5%BA%94%E7%94%A8"><span class="toc-text">内省应用</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E4%B8%8E%E5%86%85%E7%9C%81%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">反射与内省的区别</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%86%85%E7%9C%81%E6%9B%BF%E4%BB%A3%E7%9B%B4%E6%8E%A5%E4%BD%BF%E7%94%A8%E5%8F%8D%E5%B0%84%E5%8F%AF%E4%BB%A5%E9%98%B2%E6%AD%A2%E7%A0%B4%E5%9D%8F%E7%B1%BB%E7%9A%84%E5%B0%81%E8%A3%85"><span class="toc-text">使用内省替代直接使用反射可以防止破坏类的封装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%86%85%E7%9C%81%E4%B9%9F%E4%B8%80%E6%A0%B7%E5%8F%AF%E4%BB%A5%E5%86%99%E5%87%BA%E9%80%9A%E7%94%A8%E7%9A%84%E5%B7%A5%E5%85%B7"><span class="toc-text">使用内省也一样可以写出通用的工具</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-text">总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/01/07/Go%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8Fcrontab%E4%BB%BB%E5%8A%A1%E7%B3%BB%E7%BB%9F/" title="Go语言实现分布式crontab任务系统"><img src="https://static01.imgkr.com/temp/7e2ff0bcacb94fe1a60c065dd5773565.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Go语言实现分布式crontab任务系统"></a><div class="content"><a class="title" href="/2022/01/07/Go%E8%AF%AD%E8%A8%80%E5%AE%9E%E7%8E%B0%E5%88%86%E5%B8%83%E5%BC%8Fcrontab%E4%BB%BB%E5%8A%A1%E7%B3%BB%E7%BB%9F/" title="Go语言实现分布式crontab任务系统">Go语言实现分布式crontab任务系统</a><time datetime="2022-01-07T14:09:50.000Z" title="发表于 2022-01-07 22:09:50">2022-01-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/31/Go%E6%93%8D%E4%BD%9CMongoDB/" title="Go操作MongoDB"><img src="https://s3.bmp.ovh/imgs/2022/02/80bab5e678236c43.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Go操作MongoDB"></a><div class="content"><a class="title" href="/2021/12/31/Go%E6%93%8D%E4%BD%9CMongoDB/" title="Go操作MongoDB">Go操作MongoDB</a><time datetime="2021-12-31T14:09:50.000Z" title="发表于 2021-12-31 22:09:50">2021-12-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/30/Netty%E7%9F%A5%E8%AF%86%E7%82%B9%E8%AF%A6%E8%A7%A3/" title="Netty知识点详解"><img src="https://s3.bmp.ovh/imgs/2022/01/21be22e888bfda1d.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Netty知识点详解"></a><div class="content"><a class="title" href="/2021/12/30/Netty%E7%9F%A5%E8%AF%86%E7%82%B9%E8%AF%A6%E8%A7%A3/" title="Netty知识点详解">Netty知识点详解</a><time datetime="2021-12-30T06:31:42.000Z" title="发表于 2021-12-30 14:31:42">2021-12-30</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/12/28/Go%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="Go开发环境搭建"><img src="https://s3.bmp.ovh/imgs/2021/12/6c4bf5b41815150b.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Go开发环境搭建"></a><div class="content"><a class="title" href="/2021/12/28/Go%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA/" title="Go开发环境搭建">Go开发环境搭建</a><time datetime="2021-12-28T14:09:50.000Z" title="发表于 2021-12-28 22:09:50">2021-12-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2020/08/20/SpringBoot%E4%B9%8B%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE/" title="SpringBoot之数据访问-6"><img src="https://s3.bmp.ovh/imgs/2022/01/759f29a6471f2f3b.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="SpringBoot之数据访问-6"></a><div class="content"><a class="title" href="/2020/08/20/SpringBoot%E4%B9%8B%E6%95%B0%E6%8D%AE%E8%AE%BF%E9%97%AE/" title="SpringBoot之数据访问-6">SpringBoot之数据访问-6</a><time datetime="2020-08-20T14:09:50.000Z" title="发表于 2020-08-20 22:09:50">2020-08-20</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By 空白格</div><div class="footer_custom_text">欢迎来到Lemon-CS</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="font-plus" type="button" title="放大字体"><i class="fas fa-plus"></i></button><button id="font-minus" type="button" title="缩小字体"><i class="fas fa-minus"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js").then(()=>{pangu.autoSpacingPage()})}function panguInit(){panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>function loadLivere(){var e,t,o,r;"object"==typeof LivereTower?window.LivereTower.init():(e=document,t="script",r=e.getElementsByTagName(t)[0],"function"!=typeof LivereTower&&((o=e.createElement(t)).src="https://cdn-city.livere.com/js/embed.dist.js",o.async=!0,r.parentNode.insertBefore(o,r)))}{function loadOtherComment(){loadLivere()}loadLivere()}</script></div><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];pjaxSelectors.unshift('meta[property="og:image"]','meta[property="og:title"]','meta[property="og:url"]');var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(window.removeEventListener("scroll",window.tocScrollFn),window.removeEventListener("scroll",scrollCollect),"object"==typeof preloader&&preloader.initLoading(),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach(e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll(),"object"==typeof preloader&&preloader.endLoading()})),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>